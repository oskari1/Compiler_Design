open Assert
open Gradedtests
open Ast

(* These tests are provided by you *)

(* You should also add additional test cases here to help you   *)
(* debug your program.                                          *)

let unused_parser = 
  [ ("parse test 1", parse_file_test "oatprograms/tc1.oat" [ Gvdecl ({ elt = { name = "i"; init = { elt = CBool true; loc = ("oatprograms/tc1.oat", (0, 11), (0, 15)) } }; loc = ("oatprograms/tc1.oat", (0, 0), (0, 16)) }) ])
  ; ("parse test 2", parse_file_test "oatprograms/tc2.oat" [ Gvdecl ({ elt = { name = "a"; init = { elt = CNull (RArray (TInt)); loc = ("oatprograms/tc2.oat", (0, 11), (0, 21)) } }; loc = ("oatprograms/tc2.oat", (0, 0), (0, 22)) }) ])
  ; ("parse test 3", parse_file_test "oatprograms/tc3.oat" [ Gfdecl ({ elt = { frtyp = RetVal (TBool); fname = "f"; args = [ (TInt,"a") ]; body = [ { elt = Decl (("b", { elt = CBool true; loc = ("oatprograms/tc3.oat", (1, 10), (1, 14)) })); loc = ("oatprograms/tc3.oat", (1, 2), (1, 15)) } ; { elt = If ({ elt = Id "a"; loc = ("oatprograms/tc3.oat", (2, 6), (2, 7)) },[ { elt = Assn ({ elt = Id "b"; loc = ("oatprograms/tc3.oat", (2, 11), (2, 12)) },{ elt = CBool true; loc = ("oatprograms/tc3.oat", (2, 13), (2, 17)) }); loc = ("oatprograms/tc3.oat", (2, 11), (2, 18)) } ],[ { elt = Assn ({ elt = Id "b"; loc = ("oatprograms/tc3.oat", (2, 28), (2, 29)) },{ elt = CBool false; loc = ("oatprograms/tc3.oat", (2, 30), (2, 35)) }); loc = ("oatprograms/tc3.oat", (2, 28), (2, 36)) } ]); loc = ("oatprograms/tc3.oat", (2, 2), (2, 38)) } ; { elt = Ret (Some ({ elt = Id "b"; loc = ("oatprograms/tc3.oat", (3, 9), (3, 10)) })); loc = ("oatprograms/tc3.oat", (3, 2), (3, 11)) } ] }; loc = ("oatprograms/tc3.oat", (0, 0), (4, 1)) }) ])
  ; ("parse test 4", parse_file_test "oatprograms/tc4.oat" [ Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "f"; args = [  ]; body = [ { elt = Ret (Some ({ elt = Bop (Add,{ elt = CBool false; loc = ("oatprograms/tc4.oat", (1, 9), (1, 14)) },{ elt = CInt 1L; loc = ("oatprograms/tc4.oat", (1, 17), (1, 18)) }); loc = ("oatprograms/tc4.oat", (1, 9), (1, 18)) })); loc = ("oatprograms/tc4.oat", (1, 2), (1, 19)) } ] }; loc = ("oatprograms/tc4.oat", (0, 0), (2, 1)) }) ])
  ; ("parse test 5", parse_file_test "oatprograms/tc5.oat" [ Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "f"; args = [  ]; body = [ { elt = Ret (Some ({ elt = Bop (Mul,{ elt = CBool false; loc = ("oatprograms/tc5.oat", (1, 10), (1, 15)) },{ elt = CBool true; loc = ("oatprograms/tc5.oat", (1, 18), (1, 22)) }); loc = ("oatprograms/tc5.oat", (1, 10), (1, 22)) })); loc = ("oatprograms/tc5.oat", (1, 2), (1, 24)) } ] }; loc = ("oatprograms/tc5.oat", (0, 0), (2, 1)) }) ])
  ; ("parse test 6", parse_file_test "oatprograms/tc6.oat" [ Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "f"; args = [ (TInt,"i") ]; body = [ { elt = Ret (Some ({ elt = Id "i"; loc = ("oatprograms/tc6.oat", (0, 21), (0, 22)) })); loc = ("oatprograms/tc6.oat", (0, 14), (0, 23)) } ] }; loc = ("oatprograms/tc6.oat", (0, 0), (0, 24)) }) ; Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "g"; args = [ (TInt,"j") ]; body = [ { elt = Ret (Some ({ elt = Call ({ elt = Id "g"; loc = ("oatprograms/tc6.oat", (2, 21), (2, 22)) }, [ { elt = CBool true; loc = ("oatprograms/tc6.oat", (2, 23), (2, 27)) } ]); loc = ("oatprograms/tc6.oat", (2, 21), (2, 28)) })); loc = ("oatprograms/tc6.oat", (2, 14), (2, 29)) } ] }; loc = ("oatprograms/tc6.oat", (2, 0), (2, 30)) }) ])
  ; ("parse test 7", parse_file_test "oatprograms/tc7.oat" [ Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "f"; args = [  ]; body = [ { elt = Ret (Some ({ elt = CInt 0L; loc = ("oatprograms/tc7.oat", (0, 16), (0, 17)) })); loc = ("oatprograms/tc7.oat", (0, 9), (0, 18)) } ] }; loc = ("oatprograms/tc7.oat", (0, 0), (0, 19)) }) ; Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "g"; args = [  ]; body = [ { elt = For ([  ],Some ({ elt = Call ({ elt = Id "f"; loc = ("oatprograms/tc7.oat", (3, 8), (3, 9)) }, [  ]); loc = ("oatprograms/tc7.oat", (3, 8), (3, 11)) }),None,[  ]); loc = ("oatprograms/tc7.oat", (3, 2), (3, 16)) } ; { elt = Ret (Some ({ elt = CInt 0L; loc = ("oatprograms/tc7.oat", (4, 9), (4, 10)) })); loc = ("oatprograms/tc7.oat", (4, 2), (4, 11)) } ] }; loc = ("oatprograms/tc7.oat", (2, 0), (5, 1)) }) ])
  ; ("parse test 9", parse_file_test "oatprograms/tc9.oat" [ Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "f"; args = [  ]; body = [ { elt = Decl (("a", { elt = CInt 1L; loc = ("oatprograms/tc9.oat", (1, 10), (1, 11)) })); loc = ("oatprograms/tc9.oat", (1, 2), (1, 12)) } ; { elt = Ret (None); loc = ("oatprograms/tc9.oat", (2, 2), (2, 9)) } ] }; loc = ("oatprograms/tc9.oat", (0, 0), (3, 1)) }) ])
  ; ("parse test 10", parse_file_test "oatprograms/tc10.oat" [ Gfdecl ({ elt = { frtyp = RetVal (TBool); fname = "f"; args = [ (TRef ((RArray (TInt))),"a") ]; body = [ { elt = Ret (Some ({ elt = Uop (Lognot, { elt = Id "a"; loc = ("oatprograms/tc10.oat", (1, 10), (1, 11)) }); loc = ("oatprograms/tc10.oat", (1, 9), (1, 11)) })); loc = ("oatprograms/tc10.oat", (1, 2), (1, 12)) } ] }; loc = ("oatprograms/tc10.oat", (0, 0), (2, 1)) }) ])
  ; ("parse test 11", parse_file_test "oatprograms/tc11.oat" [ Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "f"; args = [  ]; body = [ { elt = Ret (Some ({ elt = Uop (Lognot, { elt = CInt 0L; loc = ("oatprograms/tc11.oat", (1, 10), (1, 11)) }); loc = ("oatprograms/tc11.oat", (1, 9), (1, 11)) })); loc = ("oatprograms/tc11.oat", (1, 2), (1, 12)) } ] }; loc = ("oatprograms/tc11.oat", (0, 0), (2, 1)) }) ])
  ; ("parse test 13", parse_file_test "oatprograms/tc13.oat" [ Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "f"; args = [  ]; body = [ { elt = Ret (Some ({ elt = CInt 0L; loc = ("oatprograms/tc13.oat", (0, 16), (0, 17)) })); loc = ("oatprograms/tc13.oat", (0, 9), (0, 18)) } ] }; loc = ("oatprograms/tc13.oat", (0, 0), (0, 19)) }) ; Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "g"; args = [  ]; body = [ { elt = SCall ({ elt = Id "f"; loc = ("oatprograms/tc13.oat", (3, 2), (3, 3)) }, [  ]); loc = ("oatprograms/tc13.oat", (3, 2), (3, 6)) } ; { elt = Ret (Some ({ elt = CInt 0L; loc = ("oatprograms/tc13.oat", (4, 9), (4, 10)) })); loc = ("oatprograms/tc13.oat", (4, 2), (4, 11)) } ] }; loc = ("oatprograms/tc13.oat", (2, 0), (5, 1)) }) ])
  ; ("parse test 14", parse_file_test "oatprograms/tc14.oat" [ Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "program"; args = [ (TInt,"argc") ; (TRef ((RArray (TRef (RString)))),"argv") ]; body = [ { elt = Decl (("a", { elt = CArr (TInt,[ { elt = CStr "hello"; loc = ("oatprograms/tc14.oat", (1, 26), (1, 27)) } ]); loc = ("oatprograms/tc14.oat", (1, 10), (1, 28)) })); loc = ("oatprograms/tc14.oat", (1, 2), (1, 29)) } ; { elt = Ret (Some ({ elt = CInt 0L; loc = ("oatprograms/tc14.oat", (2, 9), (2, 10)) })); loc = ("oatprograms/tc14.oat", (2, 2), (2, 11)) } ] }; loc = ("oatprograms/tc14.oat", (0, 0), (3, 1)) }) ])
  ; ("parse test 15", parse_file_test "oatprograms/tc15.oat" [ Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "program"; args = [ (TInt,"argc") ; (TRef ((RArray (TRef (RString)))),"argv") ]; body = [ { elt = Decl (("a", { elt = CArr (TRef (RString),[ { elt = CInt 1L; loc = ("oatprograms/tc15.oat", (1, 23), (1, 24)) } ]); loc = ("oatprograms/tc15.oat", (1, 10), (1, 25)) })); loc = ("oatprograms/tc15.oat", (1, 2), (1, 26)) } ; { elt = Ret (Some ({ elt = CInt 0L; loc = ("oatprograms/tc15.oat", (2, 9), (2, 10)) })); loc = ("oatprograms/tc15.oat", (2, 2), (2, 11)) } ] }; loc = ("oatprograms/tc15.oat", (0, 0), (3, 1)) }) ])
  ; ("parse test 16", parse_file_test "oatprograms/tc16.oat" [ Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "f"; args = [ (TInt,"x") ]; body = [ { elt = Decl (("x", { elt = CInt 0L; loc = ("oatprograms/tc16.oat", (1, 10), (1, 11)) })); loc = ("oatprograms/tc16.oat", (1, 2), (1, 12)) } ; { elt = Assn ({ elt = Id "x"; loc = ("oatprograms/tc16.oat", (2, 2), (2, 3)) },{ elt = Bop (Or,{ elt = Bop (Shl,{ elt = Bop (Shr,{ elt = Bop (Sub,{ elt = Bop (Add,{ elt = Id "x"; loc = ("oatprograms/tc16.oat", (2, 6), (2, 7)) },{ elt = Id "x"; loc = ("oatprograms/tc16.oat", (2, 10), (2, 11)) }); loc = ("oatprograms/tc16.oat", (2, 6), (2, 11)) },{ elt = Bop (Mul,{ elt = Id "x"; loc = ("oatprograms/tc16.oat", (2, 14), (2, 15)) },{ elt = Id "x"; loc = ("oatprograms/tc16.oat", (2, 18), (2, 19)) }); loc = ("oatprograms/tc16.oat", (2, 14), (2, 19)) }); loc = ("oatprograms/tc16.oat", (2, 6), (2, 19)) },{ elt = Id "x"; loc = ("oatprograms/tc16.oat", (2, 23), (2, 24)) }); loc = ("oatprograms/tc16.oat", (2, 6), (2, 24)) },{ elt = Id "x"; loc = ("oatprograms/tc16.oat", (2, 28), (2, 29)) }); loc = ("oatprograms/tc16.oat", (2, 6), (2, 29)) },{ elt = Bop (And,{ elt = Id "x"; loc = ("oatprograms/tc16.oat", (2, 32), (2, 33)) },{ elt = Bop (Sar,{ elt = Uop (Neg, { elt = Uop (Bitnot, { elt = Uop (Lognot, { elt = Id "x"; loc = ("oatprograms/tc16.oat", (2, 39), (2, 40)) }); loc = ("oatprograms/tc16.oat", (2, 38), (2, 40)) }); loc = ("oatprograms/tc16.oat", (2, 37), (2, 40)) }); loc = ("oatprograms/tc16.oat", (2, 36), (2, 40)) },{ elt = Id "x"; loc = ("oatprograms/tc16.oat", (2, 45), (2, 46)) }); loc = ("oatprograms/tc16.oat", (2, 36), (2, 46)) }); loc = ("oatprograms/tc16.oat", (2, 32), (2, 46)) }); loc = ("oatprograms/tc16.oat", (2, 6), (2, 46)) }); loc = ("oatprograms/tc16.oat", (2, 2), (2, 47)) } ; { elt = Ret (Some ({ elt = Id "x"; loc = ("oatprograms/tc16.oat", (3, 9), (3, 10)) })); loc = ("oatprograms/tc16.oat", (3, 2), (3, 11)) } ] }; loc = ("oatprograms/tc16.oat", (0, 0), (4, 1)) }) ])
  ; ("parse test 17", parse_file_test "oatprograms/tc17.oat" [ Gfdecl ({ elt = { frtyp = RetVoid; fname = "f"; args = [  ]; body = [ { elt = Decl (("x", { elt = Call ({ elt = Id "length_of_array"; loc = ("oatprograms/tc17.oat", (1, 10), (1, 25)) }, [ { elt = CInt 3L; loc = ("oatprograms/tc17.oat", (1, 26), (1, 27)) } ]); loc = ("oatprograms/tc17.oat", (1, 10), (1, 28)) })); loc = ("oatprograms/tc17.oat", (1, 2), (1, 29)) } ; { elt = Ret (None); loc = ("oatprograms/tc17.oat", (2, 2), (2, 9)) } ] }; loc = ("oatprograms/tc17.oat", (0, 0), (3, 1)) }) ])
  ; ("parse test 18", parse_file_test "oatprograms/tc18.oat" [ Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "g"; args = [  ]; body = [ { elt = Ret (Some ({ elt = Call ({ elt = Id "f"; loc = ("oatprograms/tc18.oat", (1, 9), (1, 10)) }, [  ]); loc = ("oatprograms/tc18.oat", (1, 9), (1, 12)) })); loc = ("oatprograms/tc18.oat", (1, 2), (1, 13)) } ] }; loc = ("oatprograms/tc18.oat", (0, 0), (2, 1)) }) ])
  ; ("parse test 19", parse_file_test "oatprograms/tc19.oat" [ Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "f"; args = [ (TInt,"x") ; (TInt,"y") ]; body = [ { elt = Ret (Some ({ elt = CInt 0L; loc = ("oatprograms/tc19.oat", (0, 28), (0, 29)) })); loc = ("oatprograms/tc19.oat", (0, 21), (0, 30)) } ] }; loc = ("oatprograms/tc19.oat", (0, 0), (0, 31)) }) ; Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "g"; args = [  ]; body = [ { elt = Ret (Some ({ elt = Call ({ elt = Id "f"; loc = ("oatprograms/tc19.oat", (2, 9), (2, 10)) }, [ { elt = CInt 0L; loc = ("oatprograms/tc19.oat", (2, 11), (2, 12)) } ]); loc = ("oatprograms/tc19.oat", (2, 9), (2, 13)) })); loc = ("oatprograms/tc19.oat", (2, 2), (2, 14)) } ] }; loc = ("oatprograms/tc19.oat", (1, 0), (3, 1)) }) ])
  ; ("parse test 20", parse_file_test "oatprograms/tc20.oat" [ Gfdecl ({ elt = { frtyp = RetVoid; fname = "f"; args = [ (TInt,"x") ; (TInt,"y") ]; body = [ { elt = Ret (None); loc = ("oatprograms/tc20.oat", (0, 22), (0, 29)) } ] }; loc = ("oatprograms/tc20.oat", (0, 0), (0, 30)) }) ; Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "g"; args = [  ]; body = [ { elt = SCall ({ elt = Id "f"; loc = ("oatprograms/tc20.oat", (2, 2), (2, 3)) }, [ { elt = CInt 0L; loc = ("oatprograms/tc20.oat", (2, 4), (2, 5)) } ; { elt = CInt 1L; loc = ("oatprograms/tc20.oat", (2, 6), (2, 7)) } ; { elt = CInt 2L; loc = ("oatprograms/tc20.oat", (2, 8), (2, 9)) } ]); loc = ("oatprograms/tc20.oat", (2, 2), (2, 11)) } ; { elt = Ret (Some ({ elt = CInt 0L; loc = ("oatprograms/tc20.oat", (3, 9), (3, 10)) })); loc = ("oatprograms/tc20.oat", (3, 2), (3, 11)) } ] }; loc = ("oatprograms/tc20.oat", (1, 0), (4, 1)) }) ])
  ; ("parse test ok 1", parse_file_test "oatprograms/tc_ok1.oat" [ Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "f"; args = [ (TInt,"f") ]; body = [ { elt = Ret (Some ({ elt = Id "f"; loc = ("oatprograms/tc_ok1.oat", (0, 22), (0, 23)) })); loc = ("oatprograms/tc_ok1.oat", (0, 15), (0, 24)) } ] }; loc = ("oatprograms/tc_ok1.oat", (0, 0), (0, 25)) }) ])
  ; ("parse test ok 2", parse_file_test "oatprograms/tc_ok2.oat" [ Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "f"; args = [  ]; body = [ { elt = Decl (("f", { elt = CInt 0L; loc = ("oatprograms/tc_ok2.oat", (0, 15), (0, 16)) })); loc = ("oatprograms/tc_ok2.oat", (0, 9), (0, 17)) } ; { elt = Ret (Some ({ elt = Id "f"; loc = ("oatprograms/tc_ok2.oat", (0, 25), (0, 26)) })); loc = ("oatprograms/tc_ok2.oat", (0, 18), (0, 27)) } ] }; loc = ("oatprograms/tc_ok2.oat", (0, 0), (0, 28)) }) ])
  ; ("parse test ok 5", parse_file_test "oatprograms/tc_ok5.oat" [ Gvdecl ({ elt = { name = "i"; init = { elt = CBool true; loc = ("oatprograms/tc_ok5.oat", (0, 11), (0, 15)) } }; loc = ("oatprograms/tc_ok5.oat", (0, 0), (0, 16)) }) ; Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "f"; args = [  ]; body = [ { elt = Decl (("i", { elt = CInt 0L; loc = ("oatprograms/tc_ok5.oat", (3, 10), (3, 11)) })); loc = ("oatprograms/tc_ok5.oat", (3, 2), (3, 12)) } ; { elt = Ret (Some ({ elt = Id "i"; loc = ("oatprograms/tc_ok5.oat", (4, 9), (4, 10)) })); loc = ("oatprograms/tc_ok5.oat", (4, 2), (4, 11)) } ] }; loc = ("oatprograms/tc_ok5.oat", (2, 0), (5, 1)) }) ])
  ; ("parse test ok 6", parse_file_test "oatprograms/tc_ok6.oat" [ Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "f"; args = [  ]; body = [ { elt = Decl (("i1", { elt = Bop (Add,{ elt = CInt 3L; loc = ("oatprograms/tc_ok6.oat", (1, 11), (1, 12)) },{ elt = CInt 4L; loc = ("oatprograms/tc_ok6.oat", (1, 15), (1, 16)) }); loc = ("oatprograms/tc_ok6.oat", (1, 11), (1, 16)) })); loc = ("oatprograms/tc_ok6.oat", (1, 2), (1, 17)) } ; { elt = Decl (("i2", { elt = Bop (Mul,{ elt = CInt 3L; loc = ("oatprograms/tc_ok6.oat", (2, 11), (2, 12)) },{ elt = CInt 4L; loc = ("oatprograms/tc_ok6.oat", (2, 15), (2, 16)) }); loc = ("oatprograms/tc_ok6.oat", (2, 11), (2, 16)) })); loc = ("oatprograms/tc_ok6.oat", (2, 2), (2, 17)) } ; { elt = Decl (("i3", { elt = Bop (Sub,{ elt = CInt 3L; loc = ("oatprograms/tc_ok6.oat", (3, 11), (3, 12)) },{ elt = CInt 4L; loc = ("oatprograms/tc_ok6.oat", (3, 15), (3, 16)) }); loc = ("oatprograms/tc_ok6.oat", (3, 11), (3, 16)) })); loc = ("oatprograms/tc_ok6.oat", (3, 2), (3, 17)) } ; { elt = Decl (("b1", { elt = Bop (Eq,{ elt = CInt 3L; loc = ("oatprograms/tc_ok6.oat", (5, 11), (5, 12)) },{ elt = CInt 4L; loc = ("oatprograms/tc_ok6.oat", (5, 16), (5, 17)) }); loc = ("oatprograms/tc_ok6.oat", (5, 11), (5, 17)) })); loc = ("oatprograms/tc_ok6.oat", (5, 2), (5, 18)) } ; { elt = Decl (("b2", { elt = Bop (Neq,{ elt = CInt 3L; loc = ("oatprograms/tc_ok6.oat", (6, 11), (6, 12)) },{ elt = CInt 4L; loc = ("oatprograms/tc_ok6.oat", (6, 16), (6, 17)) }); loc = ("oatprograms/tc_ok6.oat", (6, 11), (6, 17)) })); loc = ("oatprograms/tc_ok6.oat", (6, 2), (6, 18)) } ; { elt = Decl (("b6", { elt = Bop (Lt,{ elt = CInt 3L; loc = ("oatprograms/tc_ok6.oat", (7, 11), (7, 12)) },{ elt = CInt 4L; loc = ("oatprograms/tc_ok6.oat", (7, 15), (7, 16)) }); loc = ("oatprograms/tc_ok6.oat", (7, 11), (7, 16)) })); loc = ("oatprograms/tc_ok6.oat", (7, 2), (7, 17)) } ; { elt = Decl (("b7", { elt = Bop (Lte,{ elt = CInt 3L; loc = ("oatprograms/tc_ok6.oat", (8, 11), (8, 12)) },{ elt = CInt 4L; loc = ("oatprograms/tc_ok6.oat", (8, 16), (8, 17)) }); loc = ("oatprograms/tc_ok6.oat", (8, 11), (8, 17)) })); loc = ("oatprograms/tc_ok6.oat", (8, 2), (8, 18)) } ; { elt = Decl (("b8", { elt = Bop (Gt,{ elt = CInt 3L; loc = ("oatprograms/tc_ok6.oat", (9, 11), (9, 12)) },{ elt = CInt 4L; loc = ("oatprograms/tc_ok6.oat", (9, 15), (9, 16)) }); loc = ("oatprograms/tc_ok6.oat", (9, 11), (9, 16)) })); loc = ("oatprograms/tc_ok6.oat", (9, 2), (9, 17)) } ; { elt = Decl (("b9", { elt = Bop (Gte,{ elt = CInt 3L; loc = ("oatprograms/tc_ok6.oat", (10, 11), (10, 12)) },{ elt = CInt 4L; loc = ("oatprograms/tc_ok6.oat", (10, 16), (10, 17)) }); loc = ("oatprograms/tc_ok6.oat", (10, 11), (10, 17)) })); loc = ("oatprograms/tc_ok6.oat", (10, 2), (10, 18)) } ; { elt = Decl (("i4", { elt = Bop (IAnd,{ elt = CInt 3L; loc = ("oatprograms/tc_ok6.oat", (12, 11), (12, 12)) },{ elt = CInt 4L; loc = ("oatprograms/tc_ok6.oat", (12, 17), (12, 18)) }); loc = ("oatprograms/tc_ok6.oat", (12, 11), (12, 18)) })); loc = ("oatprograms/tc_ok6.oat", (12, 2), (12, 19)) } ; { elt = Decl (("b10", { elt = Bop (And,{ elt = CBool true; loc = ("oatprograms/tc_ok6.oat", (13, 12), (13, 16)) },{ elt = CBool false; loc = ("oatprograms/tc_ok6.oat", (13, 19), (13, 24)) }); loc = ("oatprograms/tc_ok6.oat", (13, 12), (13, 24)) })); loc = ("oatprograms/tc_ok6.oat", (13, 2), (13, 25)) } ; { elt = Decl (("i5", { elt = Bop (IOr,{ elt = CInt 3L; loc = ("oatprograms/tc_ok6.oat", (15, 11), (15, 12)) },{ elt = CInt 4L; loc = ("oatprograms/tc_ok6.oat", (15, 17), (15, 18)) }); loc = ("oatprograms/tc_ok6.oat", (15, 11), (15, 18)) })); loc = ("oatprograms/tc_ok6.oat", (15, 2), (15, 19)) } ; { elt = Decl (("b11", { elt = Bop (Or,{ elt = CBool true; loc = ("oatprograms/tc_ok6.oat", (16, 12), (16, 16)) },{ elt = CBool false; loc = ("oatprograms/tc_ok6.oat", (16, 19), (16, 24)) }); loc = ("oatprograms/tc_ok6.oat", (16, 12), (16, 24)) })); loc = ("oatprograms/tc_ok6.oat", (16, 2), (16, 25)) } ; { elt = Decl (("i6", { elt = Bop (Shl,{ elt = CInt 3L; loc = ("oatprograms/tc_ok6.oat", (18, 11), (18, 12)) },{ elt = CInt 4L; loc = ("oatprograms/tc_ok6.oat", (18, 16), (18, 17)) }); loc = ("oatprograms/tc_ok6.oat", (18, 11), (18, 17)) })); loc = ("oatprograms/tc_ok6.oat", (18, 2), (18, 18)) } ; { elt = Decl (("i7", { elt = Bop (Shr,{ elt = CInt 3L; loc = ("oatprograms/tc_ok6.oat", (19, 11), (19, 12)) },{ elt = CInt 4L; loc = ("oatprograms/tc_ok6.oat", (19, 16), (19, 17)) }); loc = ("oatprograms/tc_ok6.oat", (19, 11), (19, 17)) })); loc = ("oatprograms/tc_ok6.oat", (19, 2), (19, 18)) } ; { elt = Decl (("i8", { elt = Bop (Sar,{ elt = CInt 3L; loc = ("oatprograms/tc_ok6.oat", (20, 11), (20, 12)) },{ elt = CInt 4L; loc = ("oatprograms/tc_ok6.oat", (20, 17), (20, 18)) }); loc = ("oatprograms/tc_ok6.oat", (20, 11), (20, 18)) })); loc = ("oatprograms/tc_ok6.oat", (20, 2), (20, 19)) } ; { elt = Decl (("i9", { elt = Uop (Neg, { elt = CInt 3L; loc = ("oatprograms/tc_ok6.oat", (22, 13), (22, 14)) }); loc = ("oatprograms/tc_ok6.oat", (22, 11), (22, 14)) })); loc = ("oatprograms/tc_ok6.oat", (22, 2), (22, 15)) } ; { elt = Decl (("i10", { elt = Uop (Bitnot, { elt = CInt 4L; loc = ("oatprograms/tc_ok6.oat", (23, 14), (23, 15)) }); loc = ("oatprograms/tc_ok6.oat", (23, 12), (23, 15)) })); loc = ("oatprograms/tc_ok6.oat", (23, 2), (23, 16)) } ; { elt = Decl (("b12", { elt = Uop (Lognot, { elt = CBool false; loc = ("oatprograms/tc_ok6.oat", (24, 13), (24, 18)) }); loc = ("oatprograms/tc_ok6.oat", (24, 12), (24, 18)) })); loc = ("oatprograms/tc_ok6.oat", (24, 2), (24, 19)) } ; { elt = Ret (Some ({ elt = CInt 0L; loc = ("oatprograms/tc_ok6.oat", (25, 9), (25, 10)) })); loc = ("oatprograms/tc_ok6.oat", (25, 2), (25, 11)) } ] }; loc = ("oatprograms/tc_ok6.oat", (0, 0), (26, 1)) }) ])
  ; ("parse test ok 7", parse_file_test "oatprograms/tc_ok7.oat" [ Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "f"; args = [  ]; body = [ { elt = Ret (Some ({ elt = Call ({ elt = Id "g"; loc = ("oatprograms/tc_ok7.oat", (1, 9), (1, 10)) }, [  ]); loc = ("oatprograms/tc_ok7.oat", (1, 9), (1, 12)) })); loc = ("oatprograms/tc_ok7.oat", (1, 2), (1, 13)) } ] }; loc = ("oatprograms/tc_ok7.oat", (0, 0), (2, 1)) }) ; Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "g"; args = [  ]; body = [ { elt = Ret (Some ({ elt = Call ({ elt = Id "f"; loc = ("oatprograms/tc_ok7.oat", (5, 9), (5, 10)) }, [  ]); loc = ("oatprograms/tc_ok7.oat", (5, 9), (5, 12)) })); loc = ("oatprograms/tc_ok7.oat", (5, 2), (5, 13)) } ] }; loc = ("oatprograms/tc_ok7.oat", (4, 0), (6, 1)) }) ])
  ; ("parse test ok 8", parse_file_test "oatprograms/tc_ok8.oat" [ Gfdecl ({ elt = { frtyp = RetVal (TInt); fname = "f"; args = [  ]; body = [ { elt = Decl (("a1", { elt = CArr (TInt,[ { elt = CInt 1L; loc = ("oatprograms/tc_ok8.oat", (1, 21), (1, 22)) } ; { elt = CInt 2L; loc = ("oatprograms/tc_ok8.oat", (1, 24), (1, 25)) } ; { elt = CInt 3L; loc = ("oatprograms/tc_ok8.oat", (1, 27), (1, 28)) } ]); loc = ("oatprograms/tc_ok8.oat", (1, 11), (1, 29)) })); loc = ("oatprograms/tc_ok8.oat", (1, 2), (1, 30)) } ; { elt = Decl (("b", { elt = CArr (TRef (RString),[ { elt = CStr "a"; loc = ("oatprograms/tc_ok8.oat", (2, 25), (2, 26)) } ; { elt = CStr "b"; loc = ("oatprograms/tc_ok8.oat", (2, 30), (2, 31)) } ; { elt = CStr "c"; loc = ("oatprograms/tc_ok8.oat", (2, 35), (2, 36)) } ; { elt = CStr "d"; loc = ("oatprograms/tc_ok8.oat", (2, 40), (2, 41)) } ]); loc = ("oatprograms/tc_ok8.oat", (2, 10), (2, 42)) })); loc = ("oatprograms/tc_ok8.oat", (2, 2), (2, 43)) } ; { elt = Decl (("s", { elt = Call ({ elt = Id "string_of_array"; loc = ("oatprograms/tc_ok8.oat", (3, 10), (3, 25)) }, [ { elt = Id "a1"; loc = ("oatprograms/tc_ok8.oat", (3, 26), (3, 28)) } ]); loc = ("oatprograms/tc_ok8.oat", (3, 10), (3, 29)) })); loc = ("oatprograms/tc_ok8.oat", (3, 2), (3, 30)) } ; { elt = Decl (("a2", { elt = Call ({ elt = Id "array_of_string"; loc = ("oatprograms/tc_ok8.oat", (4, 11), (4, 26)) }, [ { elt = CStr "abc"; loc = ("oatprograms/tc_ok8.oat", (4, 31), (4, 32)) } ]); loc = ("oatprograms/tc_ok8.oat", (4, 11), (4, 33)) })); loc = ("oatprograms/tc_ok8.oat", (4, 2), (4, 34)) } ; { elt = SCall ({ elt = Id "print_string"; loc = ("oatprograms/tc_ok8.oat", (5, 2), (5, 14)) }, [ { elt = CStr "hello"; loc = ("oatprograms/tc_ok8.oat", (5, 21), (5, 22)) } ]); loc = ("oatprograms/tc_ok8.oat", (5, 2), (5, 24)) } ; { elt = SCall ({ elt = Id "print_int"; loc = ("oatprograms/tc_ok8.oat", (6, 2), (6, 11)) }, [ { elt = CInt 3L; loc = ("oatprograms/tc_ok8.oat", (6, 12), (6, 13)) } ]); loc = ("oatprograms/tc_ok8.oat", (6, 2), (6, 15)) } ; { elt = SCall ({ elt = Id "print_bool"; loc = ("oatprograms/tc_ok8.oat", (7, 2), (7, 12)) }, [ { elt = CBool true; loc = ("oatprograms/tc_ok8.oat", (7, 13), (7, 17)) } ]); loc = ("oatprograms/tc_ok8.oat", (7, 2), (7, 19)) } ; { elt = Ret (Some ({ elt = CInt 0L; loc = ("oatprograms/tc_ok8.oat", (8, 9), (8, 10)) })); loc = ("oatprograms/tc_ok8.oat", (8, 2), (8, 11)) } ] }; loc = ("oatprograms/tc_ok8.oat", (0, 0), (9, 1)) }) ])
  ]

let unused_programs = [
  ("oatprograms/abs.oat", "", "200");
  (* Calculator first prints then returns the result *)
  ("oatprograms/calculator.oat", "7 5 +", "1212");
  ("oatprograms/calculator.oat", "52 79 -", "2727");
  ("oatprograms/calculator.oat", "5 8 x", "4040");
  ("oatprograms/calculator.oat", "3 5 8 x - 19 +", "5656");
  ("oatprograms/float_multiply.oat", "", "79.1765750");
  ("oatprograms/hashcode.oat", "", "31040");
  ("oatprograms/kmp.oat", "", "7");
  ("oatprograms/leastsquare.oat", "", "2");
  ("oatprograms/no_of_fac.oat", "", "27");
  ("oatprograms/qs_bs.oat", "", "57");
  ("oatprograms/regalloctest2.oat", "", "137999986200000000");
  ("oatprograms/regex.oat", "", "1");
  ("oatprograms/reverse.oat", "", "123");
  ("oatprograms/rod_cutting.oat", "", "35");
  ("oatprograms/run51.oat", "", "341");
  ("oatprograms/run52.oat", "", "15");
  ("oatprograms/run54.oat", "", "10");
  ("oatprograms/run55.oat", "", "6");
  ("oatprograms/run56.oat", "", "7");
  ("oatprograms/setg.oat", "", "00");
  ("oatprograms/union_find.oat", "", "7 6 7 3 4 7 6 7 0");
  ("oatprograms/xor_bool.oat", "", "0");
]


let provided_tests : suite = 
[
  Test ("Unused parser tests", unused_parser);
  Test ("Unused oat files", (Gradedtests.executed_oat_file unused_programs));
] 